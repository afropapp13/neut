      real*4 function nrcst(ekin,ka,prot)
      implicit none
      real*4 ekin
      integer ka,kb,ks,ierr
      logical prot
      real*4 dcln(5,16),dcin(5,23),dchn(143),dchna(9,4),dchnb(12,5),
     &        pdci(12,5),pdch(11,5)
c        a   p-n elastic 0-300 dcln(5,16)
       data dcln/
     & 0.5000,     1.0000,     0.0000,     1.0000,     0.0000,
     & 0.49925579, 0.98807495, 0.05962521, 0.98513799, 0.05944798,
     & 0.49355433, 0.89552238, 0.52238806, 0.87272726, 0.50909091,
     & 0.48889623, 0.82281334, 0.88593328, 0.78706199, 0.85175203,
     & 0.48738898, 0.75801749, 1.20991250, 0.72072072, 1.11711710,
     & 0.49122806, 0.69686411, 1.51567940, 0.67283431, 1.30866270,
     & 0.50746268, 0.64705882, 1.76470590, 0.66666667, 1.33333330,
     & 0.53832226, 0.60538116, 1.97309420, 0.70588234, 1.17647060,
     & 0.53970484, 0.59895833, 2.00520830, 0.70229007, 1.19083970,
     & 0.53358065, 0.60834298, 1.95828500, 0.69594034, 1.21623860,
     & 0.53165374, 0.60753340, 1.96233290, 0.68965518, 1.24137930,
     & 0.53004363, 0.60164661, 1.99176690, 0.67857142, 1.28571430,
     & 0.52814290, 0.60625399, 1.96873000, 0.67857142, 1.28571430,
     & 0.52797202, 0.59602648, 2.01986750, 0.66666666, 1.33333330,
     & 0.52729218, 0.59201624, 2.03991880, 0.66037736, 1.35849060,
     & 0.52727272, 0.58620688, 2.06896550, 0.65384615, 1.38461540
     & /
c     a   p-n elastic 300-740 dcin(5,23)
       data dcin/
     & 0.52230970, 0.59798994, 2.81407030, 0.65384615, 1.38461540,
     & 0.52016129, 0.59689922, 2.82170540, 0.64705882, 1.41176470,
     & 0.51825842, 0.58807588, 2.88346880, 0.63265305, 1.46938770,
     & 0.51585014, 0.58659217, 2.89385470, 0.6250,     1.5000,
     & 0.51331360, 0.58501440, 2.90489910, 0.61702128, 1.53191490,
     & 0.51063829, 0.58333333, 2.91666670, 0.60869565, 1.56521740,
     & 0.50842696, 0.58011049, 2.93922650, 0.6000,     1.6000,
     & 0.50625200, 0.57631412, 2.96580110, 0.59090908, 1.63636360,
     & 0.50362796, 0.57301899, 2.98886710, 0.58139535, 1.67441860,
     & 0.50135684, 0.56833558, 3.02165090, 0.57142857, 1.71428570,
     & 0.49860237, 0.56412054, 3.05115630, 0.56097560, 1.75609760,
     & 0.49640287, 0.55797100, 3.09420290, 0.54999999, 1.8000,
     & 0.49357326, 0.55729166, 3.09895830, 0.54314720, 1.82741120,
     & 0.49090909, 0.55092592, 3.14351850, 0.53125000, 1.8750,
     & 0.48846153, 0.55118110, 3.14173230, 0.52631578, 1.89473680,
     & 0.48570293, 0.54374489, 3.19378580, 0.51351350, 1.94594590,
     & 0.48297086, 0.53525913, 3.25318610, 0.5000,     2.0000,
     & 0.48006713, 0.53234265, 3.27360140, 0.49152542, 2.03389830,
     & 0.47697654, 0.52276866, 3.34061930, 0.47674418, 2.09302330,
     & 0.47382549, 0.51558073, 3.39093480, 0.46428571, 2.14285710,
     & 0.47009346, 0.50099403, 3.49304170, 0.44444444, 2.22222220,
     & 0.46717411, 0.49898167, 3.50712830, 0.43749999, 2.2500,
     & 0.46340256, 0.48559232, 3.60085380, 0.41935483, 2.32258060
     & /
c     a   p-n elastic frac back dchn(143)
       data dchn/
     & 0.47700, 0.47500, 0.47150, 0.46850, 0.46500,
     & 0.46100, 0.45700, 0.45500, 0.45000, 0.44500,
     & 0.44050, 0.43500, 0.43000, 0.42500, 0.42000,
     & 0.41300, 0.40600, 0.40000, 0.39150, 0.38400,
     & 0.37600, 0.36750, 0.35800, 0.35000, 0.34000,
     & 0.33000, 0.32000, 0.31000, 0.30000, 0.29000,
     & 0.28000, 0.27000, 0.26000, 0.25000, 0.24000,
     & 0.23150, 0.22400, 0.21500, 0.20600, 0.20000,
     & 0.19150, 0.18500, 0.17800, 0.17200, 0.16600,
     & 0.16000, 0.15500, 0.15000, 0.14500, 0.14000,
     & 0.13600, 0.13200, 0.12800, 0.12500, 0.12100,
     & 0.11800, 0.11500, 0.11200, 0.11000, 0.10700,
     & 0.10500, 0.10300, 0.10100, 0.09900, 0.09700,
     & 0.09550, 0.09480, 0.09400, 0.09200, 0.09150,
     & 0.09100, 0.09000, 0.08990, 0.08900, 0.08850,
     & 0.08750, 0.08700, 0.08650, 0.08550, 0.08500,
     & 0.08500, 0.08450, 0.08350, 0.08300, 0.08250,
     & 0.08150, 0.08100, 0.08030, 0.08000, 0.07990,
     & 0.07980, 0.07950, 0.07900, 0.07860, 0.07800,
     & 0.07750, 0.07650, 0.07620, 0.07600, 0.07550,
     & 0.07530, 0.07500, 0.07499, 0.07498, 0.07480,
     & 0.07450, 0.07400, 0.07350, 0.07300, 0.07250,
     & 0.07230, 0.07200, 0.07100, 0.07050, 0.07020,
     & 0.07000, 0.06999, 0.06995, 0.06993, 0.06991,
     & 0.06990, 0.06870, 0.06850, 0.06800, 0.06780,
     & 0.06750, 0.06700, 0.06650, 0.06630, 0.06600,
     & 0.06550, 0.06525, 0.06510, 0.06500, 0.06499,
     & 0.06498, 0.06496, 0.06494, 0.06493, 0.06490,
     & 0.06488, 0.06485, 0.06480
     & /
c     a   p-n elastic ang forward dchna(9,4)
       data dchna/
     & 630.,
     & 0.7810, 0.1421, 0.1979, 0.2479,
     & 0.3360, 0.5400, 0.7236, 1.000,
     & 1540.,
     & 0.22250, 0.39500, 0.52788, 0.62976,
     & 0.77176, 0.94051, 0.98351, 1.00000,
     & 2560.,
     & 0.2625, 0.45500, 0.59625, 0.7020,
     & 0.8380, 0.96025, 0.99025, 1.0000,
     & 3520.,
     & 0.4250, 0.6875, 0.8363, 0.9163,
     & 0.9828, 1.000,  1.000,  1.000 /
c     a   p-n elastic ang back dchnb(12,5)
       data dchnb/
     & 630.,
     & 0.03800, 0.07164, 0.12754, 0.21714,
     & 0.32274, 0.40914, 0.50514, 0.60614,
     & 0.70742, 0.84342, 1.000,
     & 2040.,
     & 0.1200, 0.2115, 0.3395, 0.5295,
     & 0.7251, 0.8511, 0.9487, 0.9987,
     & 1.000, 1.000, 1.000,
     & 2200.,
     & 0.1344, 0.2324, 0.3754, 0.5674,
     & 0.7624, 0.8896, 0.9808, 1.000,
     & 1.000, 1.000, 1.000,
     & 2850.,
     & 0.2330, 0.4130, 0.6610, 0.9010,
     & 0.9970, 1.000, 1.000, 1.000,
     & 1.000,  1.000, 1.000,
     & 3500.,
     & 0.3300, 0.5450, 0.7950, 1.000,
     & 1.000, 1.000, 1.000, 1.000,
     & 1.000, 1.000, 1.000 /
c      a   p-p elastic 500-1000 pdci(12,5)
       data pdci/
     & 440.,
     & 0.18960, 0.19310, 0.19825, 0.10150,
     & 0.10295, 0.04180, 0.04228, 0.04282,
     & 0.04350, 0.02204, 0.02236,
     & 590.,
     & 0.14325, 0.15555, 0.17745, 0.10000,
     & 0.11275, 0.05132, 0.05600, 0.06158,
     & 0.06796, 0.03660, 0.03820,
     & 650.,
     & 0.119244, 0.133368, 0.162017, 0.095265,
     & 0.114059, 0.052833, 0.059519, 0.067648,
     & 0.078779, 0.047958, 0.069570,
     & 800.,
     & 0.048719, 0.066936, 0.115239, 0.093482,
     & 0.136839, 0.069122, 0.079532, 0.095772,
     & 0.122213, 0.077555, 0.095252,
     & 1000.,
     & 0.039970, 0.054563, 0.098043, 0.080842,
     & 0.120811, 0.065195, 0.082326, 0.108424,
     & 0.147441, 0.093279, 0.109327 /
c       a   p-p elastic 1000-3500 pdch(11,5)
       data pdch/
     & 1000.,
     & 0.094533, 0.098043, 0.080842, 0.120811,
     & 0.065195, 0.082326, 0.108424, 0.147441,
     & 0.093279, 0.109327,
     & 1400.,
     & 0.10725, 0.07450, 0.06645, 0.1136,
     & 0.06750, 0.08580, 0.11100, 0.1530,
     & 0.10100, 0.1350,
     & 2170.,
     & 0.04004, 0.03013, 0.02664, 0.05511,
     & 0.04240, 0.07660, 0.13640, 0.23000,
     & 0.16700, 0.2010,
     & 2900.,
     & 0.01870, 0.01804, 0.01320, 0.02970,
     & 0.02860, 0.05160, 0.10200, 0.2400,
     & 0.22500, 0.33700,
     & 4400.,
     & 0.001196, 0.008784, 0.015171, 0.028745,
     & 0.024884, 0.044642, 0.083304, 0.200784,
     & 0.236028, 0.356710 /

      if(prot) then
         kb=1
      else
         kb=0
      end if
      ks=ka+kb
      if(ks.ne.1) then       !p-p or n-n
         if(ekin.lt.500) then
            nrcst = 2.
         else if(ekin.lt.1000.) then
            call nrctpp(pdci,12,ekin,nrcst,ierr)
         else if(ekin.lt.3500.) then
            call nrctpp(pdch,11,ekin,nrcst,ierr)
         else
            ierr=1
         end if
         if(ierr.eq.1) nrcst = 2.
      else                   !p-n n-p
         if(ekin.lt.740.) then
            call nrctpnl(dcln,dcin,ekin,nrcst,ierr)
         else if(ekin.lt.3500.) then
            call nrctpnh(dchn,dchna,dchnb,ekin,nrcst,ierr)
         else
            ierr=1
         end if
         if(ierr.eq.1) nrcst = 2.
      end if
      return
      end
