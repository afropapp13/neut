************************************************************************
*     ---------------------------------
      REAL FUNCTION DCOHMXNEKART(E)
*     ---------------------------------
*
*     (Purpose)
*     Return the maximum value of the function "dcohnekart"
*
*     (Input)
*       E     : INCIDENT NEUTRINO ENERGY ( GEV )      
*
*     (Output)
*       Maximum value of the function dcohnekart
*      
*     (Creation Date and Author)
*       2007.01.08  G.Mitsuka
*       2007.11.05  G.Mitsuka -- support target nucleus besides 16O
*
*     (Comment)
*
************************************************************************

#include "necard.h"
C     Scaling factor
      REAL FACTOR

C     Charged Current
      REAL SIGMAXCC(109),SIG1CC(50),SIG2CC(50),SIG3CC(9)
      EQUIVALENCE (SIGMAXCC( 1),SIG1CC(1))
      EQUIVALENCE (SIGMAXCC(51),SIG2CC(1))
      EQUIVALENCE (SIGMAXCC(101),SIG3CC(1))

C     Neutral Current      
      REAL SIGMAXNC(109),SIG1NC(50),SIG2NC(50),SIG3NC(9)
      EQUIVALENCE (SIGMAXNC( 1),SIG1NC(1))
      EQUIVALENCE (SIGMAXNC(51),SIG2NC(1))
      EQUIVALENCE (SIGMAXNC(101),SIG3NC(1))

C     Data for Charged Current
      DATA SIG1CC/2.9283e+05,3.4225e+05,3.7150e+05,3.8420e+05,3.9103e+05,
     & 3.9522e+05,3.9850e+05,4.0066e+05,4.0231e+05,4.0356e+05,
     & 4.0511e+05,4.0572e+05,4.0657e+05,4.0717e+05,4.0819e+05,
     & 4.0788e+05,4.0834e+05,4.0908e+05,4.0947e+05,4.0968e+05,
     & 4.0986e+05,4.1004e+05,4.1035e+05,4.1098e+05,4.1094e+05,
     & 4.1106e+05,4.1118e+05,4.1079e+05,4.1121e+05,4.1146e+05,
     & 4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,
     & 4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,
     & 4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,
     & 4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05/
      DATA SIG2CC/4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,
     & 4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,
     & 4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,
     & 4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,
     & 4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,
     & 4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,
     & 4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,
     & 4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,
     & 4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,
     & 4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05/
      DATA SIG3CC/4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05,
     & 4.1437e+05,4.1437e+05,4.1437e+05,4.1437e+05/

C     Data for Neutral Current
      DATA SIG1NC/3.0470e+05,3.3499e+05,3.5295e+05,3.6061e+05,3.6485e+05,
     & 3.6754e+05,3.6940e+05,3.7077e+05,3.7181e+05,3.7263e+05,
     & 3.7330e+05,3.7385e+05,3.7431e+05,3.7470e+05,3.7504e+05,
     & 3.7534e+05,3.7560e+05,3.7583e+05,3.7603e+05,3.7622e+05,
     & 3.7638e+05,3.7653e+05,3.7667e+05,3.7680e+05,3.7691e+05,
     & 3.7702e+05,3.7712e+05,3.7721e+05,3.7729e+05,3.7737e+05,
     & 3.7744e+05,3.7751e+05,3.7758e+05,3.7764e+05,3.7770e+05,
     & 3.7775e+05,3.7780e+05,3.7785e+05,3.7790e+05,3.7794e+05,
     & 3.7798e+05,3.7802e+05,3.7806e+05,3.7809e+05,3.7813e+05,
     & 3.7816e+05,3.7819e+05,3.7822e+05,3.7825e+05,3.7828e+05/
      DATA SIG2NC/3.7830e+05,3.7833e+05,3.7836e+05,3.7838e+05,3.7840e+05,
     & 3.7842e+05,3.7844e+05,3.7846e+05,3.7848e+05,3.7850e+05,
     & 3.7852e+05,3.7854e+05,3.7856e+05,3.7857e+05,3.7859e+05,
     & 3.7860e+05,3.7862e+05,3.7864e+05,3.7865e+05,3.7866e+05,
     & 3.7868e+05,3.7869e+05,3.7870e+05,3.7872e+05,3.7873e+05,
     & 3.7874e+05,3.7875e+05,3.7876e+05,3.7877e+05,3.7878e+05,
     & 3.7879e+05,3.7880e+05,3.7881e+05,3.7882e+05,3.7883e+05,
     & 3.7884e+05,3.7885e+05,3.7886e+05,3.7887e+05,3.7888e+05,
     & 3.7888e+05,3.7889e+05,3.7890e+05,3.7891e+05,3.7892e+05,
     & 3.7892e+05,3.7893e+05,3.7894e+05,3.7894e+05,3.7895e+05/
      DATA SIG3NC/3.7918e+05,3.7935e+05,3.7943e+05,3.7947e+05,3.7950e+05,
     & 3.7952e+05,3.7953e+05,3.7954e+05,3.7955e+05/
      
      IE = INT(AINT(E))+1
      IF (IE.gt.100) THEN
         IE = 100 + AINT(E/100.)
         IF (IE.GT.109) THEN
            write(*,*) "E is OUT OF RANGE...(E=",E,")"
            write(*,*) "(Approx by E=1000.)"
            IE = 109
         ENDIF
      ENDIF
*     scaling factor is applied for other target than 16O
      FACTOR=(float(NUMATOM)/16.)**(1./3.)
      if(abs(modene).eq.16) DCOHMXNEKART = SIGMAXCC(IE)*FACTOR
      if(abs(modene).eq.36) DCOHMXNEKART = SIGMAXNC(IE)*FACTOR
      
      RETURN
      END
      
