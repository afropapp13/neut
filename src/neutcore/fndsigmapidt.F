************************************************************************
*     ---------------------------------
      double precision function fndsigmapidt(nu,t)
*     ---------------------------------
*
*     (Purpose)
*       Return dsigma(pi+12C->pi+12C)/dt
*
*     (Input)
*       nu  : Energy transfer
*       t   :
*     (Output)
*       fndsigmapidt : dsigma(pi+12C->pi+12C)/dt
*      
*     (Creation Date and Author)
*       2007.01.08 ; G.Mitsuka
*
*     (Comment)
*       This table is given by A.Kartavtsev
*
************************************************************************

      implicit none

      integer i, j, N(7)
      real*8 texp(17,7), dsigma(17,7)
      real*8 nu,t, Ek
      real*8 x1,x2, y1,y2
      real*8 a,b
      real*8 Mpi

      Mpi= 0.138d0

      data N/17,13,13,11,11,11,10/

c---------- t data for 120 MeV ---------------------------------------------
      data texp/1.63d-3,  1.96d-3,  2.31d-3,  2.68d-3,
     #3.09d-3,  3.53d-3,  4.74d-3,  6.12d-3,  9.37d-3,
     #1.329d-2, 1.783d-2, 2.303d-2, 2.868d-2, 3.482d-2,
     #4.139d-2, 4.834d-2, 5.561d-2,
c---------- t data for 150 MeV ---------------------------------------------
     #1.91d-3,  2.31d-3,  2.99d-3,  4.3d-3,   7.65d-3,
     #1.198d-2, 1.712d-2, 2.308d-2, 2.982d-2, 3.728d-2,
     #4.539d-2, 5.409d-2, 5.863d-2, 6.331d-2, 7.295d-2,
     #8.297d-2,9.327d-2,
c---------- t data for 180 MeV ---------------------------------------------
     #2.45d-3,  2.97d-3,  3.83d-3,  5.53d-3,  7.52d-3,
     #9.81d-3,  1.523d-2, 2.181d-2, 2.94d-2,  3.767d-2,
     #4.716d-2, 5.223d-2, 5.751d-2, 6.295d-2, 6.858d-2,
     #8.035d-2,9.265d-2,
c---------- t data for 200 MeV ---------------------------------------------
     #3.44d-3,  4.1d-3,   6.41d-3,  1.137d-2, 1.768d-2,
     #2.531d-2, 3.412d-2, 4.452d-2, 5.561d-2, 6.152d-2,
     #6.766d-2, 7.403d-2, 8.058d-2, 9.397d-2, 0.10827d0,
     #0.12307d0,0.13832d0,
c---------- t data for 230 MeV ---------------------------------------------
     #3.61d-3,  4.36d-3,  5.18d-3,  8.04d-3,  1.419d-2,
     #2.199d-2, 3.133d-2, 4.224d-2, 5.42d-2,  6.08d-2,
     #6.772d-2, 7.492d-2, 8.24d-2,  9.815d-2, 0.11483d0,
     #0.13226d0,0.13226d0,
c---------- t data for 260 MeV ---------------------------------------------
     #4.32d-3,  5.22d-3,  6.71d-3,  9.63d-3,  1.694d-2,
     #2.625d-2, 3.747d-2, 5.043d-2, 5.723d-2, 6.474d-2,
     #7.264d-2, 8.089d-2, 8.949d-2, 9.844d-2, 0.11721d0,
     #0.13707d0,0.15786d0,
c---------- t data for 280 MeV ---------------------------------------------
     #5.33d-3,  6.93d-3,  9.88d-3,  1.42d-2,  1.803d-2, 
     #2.823d-2, 4.049d-2, 5.483d-2, 7.268d-2, 8.151d-2,
     #9.072d-2, 1.0033d-1,1.1032d-1,0.13132d0,0.15353d0,
     #0.17673d0,0.20077d0/
c-------------------------------------------------------------------------


c--- dsigma data for 120 MeV ---------------------------------------------
      data dsigma/27.2957d0,23.90174d0,22.39331d0,21.54996d0,
     #20.03468d0,17.72404d0,16.3116d0, 13.76784d0,9.49624d0,
     #6.14342d0, 4.1139d0,  1.98838d0, 0.85021d0, 0.41619d0,
     #0.22352d0, 0.13507d0, 0.10285d0,
c--- dsigma data for 150 MeV ---------------------------------------------
     #24.49353d0,22.17234d0,21.07607d0,18.81149d0,13.60809d0,
     #8.74438d0, 5.04899d0, 2.58883d0, 1.17861d0, 0.42718d0,
     #0.13176d0, 6.073d-2,  3.603d-2,  5.25d-2,   7.617d-2,
     #6.536d-2,  6.279d-2,
c--- dsigma data for 180 MeV ---------------------------------------------
     #18.64452d0,18.34198d0,16.01847d0,14.60259d0,12.65423d0,
     #9.76598d0, 5.96205d0, 3.0375d0,  1.24243d0, 0.35216d0,
     #5.97d-2,   1.856d-2,  4.56d-3,   1.614d-2,  2.098d-2,
     #6.051d-2,  6.454d-2,
c--- dsigma data for 200 MeV ---------------------------------------------
     #16.02447d0,14.70218d0,12.43091d0,7.8814d0,  4.51113d0,
     #2.06542d0, 0.73964d0, 0.14653d0, 1.884d-2,  1.779d-2,
     #1.047d-2,  3.175d-2,  3.663d-2,  4.57d-2,   3.698d-2,
     #2.407d-2,  1.047d-2,
c--- dsigma data for 230 MeV ---------------------------------------------
     #12.91985d0,11.87663d0,11.4582d0, 9.25426d0, 5.43677d0,
     #2.69116d0, 0.99736d0, 0.33532d0, 5.417d-2,  0.03067d0,
     #2.207d-2,  2.981d-2,  3.095d-2,  4.414d-2,  4.156d-2,
     #1.978d-2,  1.978d-2,
c--- dsigma data for 260 MeV ---------------------------------------------
     #12.58448d0,10.73162d0,10.86173d0,7.32227d0, 4.43095d0,
     #2.01188d0, 0.73006d0, 0.19757d0, 0.10144d0, 0.04144d0,
     #0.02602d0, 0.03542d0, 0.04337d0, 0.04361d0, 0.03421d0,
     #0.02626d0, 0.01253d0,
c--- dsigma data for 280 MeV ---------------------------------------------
     #8.37126d0, 7.65743d0, 6.07835d0, 4.78049d0, 3.37879d0,
     #1.49471d0, 0.52131d0, 0.12113d0, 0.03483d0, 0.02834d0,
     #0.03396d0, 0.03158d0, 0.02942d0, 0.02963d0, 0.01904d0, 
     #0.01298d0, 0.00324d0/
c-------------------------------------------------------------------------
      Ek=nu-Mpi

      if (Ek.lt.0.135d0) then
      j=1      
      elseif (Ek.lt.0.165d0) then
      j=2       
      elseif (Ek.lt.0.19d0) then
      j=3
      elseif (Ek.lt.0.215d0) then
      j=4      
      elseif (Ek.lt.0.245d0) then
      j=5 
      elseif (Ek.lt.0.27d0) then
      j=6 
      else
      j=7 
      endif     


      if (t.lt.texp(2,j)) then
      x1=texp(1,j)
      x2=texp(2,j)

      y1=log(dsigma(1,j))
      y2=log(dsigma(2,j))
     
      elseif (t.gt.texp(N(j)-1,j)) then
      x1=texp(N(j)-1,j)
      x2=texp(N(j),j)

      y1=log(dsigma(N(j)-1,j))
      y2=log(dsigma(N(j),j))

      else
      do 100 i=3,(N(j)-1)
      if (texp(i,j).gt.t) then

      x1=texp(i-1,j)
      x2=texp(i,j)

      y1=log(dsigma(i-1,j))
      y2=log(dsigma(i,j))
      goto 101
      endif
 100  continue
      endif
 101  continue
      a=(y1*x2-x1*y2)/(x2-x1)

      b=(y2-y1)/(x2-x1)

      fndsigmapidt=Exp(a+b*t)

      end


