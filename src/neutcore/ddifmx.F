************************************************************************
*     ---------------------------------
      REAL FUNCTION DDIFMX(E)
*     ---------------------------------
*
*     (Purpose)
C     THIS SUBROUTINE IS FOR 'DIFVCT' THAT IS DIFERENT PI0 PRODUCTION
C     PROGRAM. HERE,WE GIVE THE MAX VALUE OF THE FUNCTION 'DDIFNEREIN'.
C     for any reasonable choice of nu flavor & interaction type
*
*     (Input)
C       E     : INCIDENT NEUTRINO ENERGY ( GEV )      
C
*     (Output)
C       Maximum value of function DDIFNEREIN
*      
*     (Creation Date and Author)
*       2016.02.02 ; R. Terri  modified from dcohmxnerein.F
*
*     (Comment)
*
*
************************************************************************

#include "necard.h"
C      REAL SIGMAX(100),SIG1(50),SIG2(50)
      REAL SIGMAX(109),SIG1(50),SIG2(50),SIG3(9)
      EQUIVALENCE (SIGMAX( 1),SIG1(1))
      EQUIVALENCE (SIGMAX(51),SIG2(1))
      EQUIVALENCE (SIGMAX(101),SIG3(1))
      REAL WIGMAX(109),WIG1(50),WIG2(50),WIG3(9)
      EQUIVALENCE (WIGMAX( 1),WIG1(1))
      EQUIVALENCE (WIGMAX(51),WIG2(1))
      EQUIVALENCE (WIGMAX(101),WIG3(1))
      

       DATA SIG1/2.6032700,  5.6795000,  8.7561300, 11.8304000, 14.9095000,
     & 17.9816000, 21.0637000, 24.1332000, 27.2105000, 30.2815000,
     & 33.3694000, 36.442, 39.5008000, 42.5409000, 45.6529000,
     & 48.7388000, 51.7915000, 54.9188000, 57.9585000, 61.0288000,
     & 64.1476000, 67.2125000, 70.2714000, 73.3443000, 76.4616000,
     & 79.4474000, 82.5654000, 85.0255000, 88.6777000, 91.8249000,
     & 94.8817000, 97.9499000, 100.851, 104.11, 107.169,
     & 110.064, 113.386, 116.06, 119.462, 122.193,
     & 125.681, 128.295, 131.857, 134.573, 137.834,
     & 141.024, 143.586, 147.109, 148.864, 152.74/
      DATA SIG2/155.80, 159.443, 162.07, 164.485, 168.68,
     & 170.198, 174.289, 176.586, 180.957, 184.13,
     & 186.791, 189.098, 191.935, 196.372, 199.429,
     & 202.189, 204.485, 206.669, 210.788, 214.892,
     & 217.855, 220.614, 223.03, 225.193, 227.407,
     & 232.586, 236.341, 239.404, 242.111, 244.678,
     & 246.975, 249.149, 251.226, 256.067, 260.684,
     & 264.19, 267.114, 269.633, 271.961, 274.472,
     & 276.168, 277.50, 280.76, 284.789, 290.849,
     & 294.795, 297.619, 298.205, 303.526, 305.97/
      DATA SIG3/305.97, 612.43, 881.238, 1225.35, 1401.22,
     & 1548.14, 1681.72, 2451.19, 2644.77/

       DATA WIG1/0.00,  0.4152550,  1.6484500,  2.8820100,  4.1157900,
     &  5.3486200,  6.5784100,  7.8166100,  9.0572200, 10.2716000,
     & 11.5072000, 12.7526000, 13.9644000, 15.1925000, 16.457,
     & 17.6684000, 18.886, 20.1677000, 21.3556000, 22.6326000,
     & 23.8711000, 25.0075000, 26.3288000, 27.5045000, 28.7679000,
     & 29.9735000, 31.2431000, 32.4751000, 33.7374000, 34.9108000,
     & 36.1444000, 37.3571000, 38.5427000, 39.8137000, 41.0744000,
     & 42.3885000, 43.5444000, 44.847, 45.9687000, 47.3191000,
     & 48.4461000, 49.7955000, 50.8415000, 52.0668000, 53.3889000,
     & 54.7126000, 55.763, 57.1245000, 58.2982000, 59.4834000/
      DATA WIG2/60.7961000, 62.131, 63.2376000, 64.1543000, 65.5977000,
     & 67.0084000, 68.2976000, 69.3815000, 70.6258000, 71.7937000,
     & 73.0631000, 74.003, 75.465, 76.9429000, 78.1773000,
     & 79.1481000, 80.484, 81.7487000, 83.0266000, 84.1414000,
     & 85.1331000, 86.7165000, 87.8611000, 89.1502000, 90.3145000,
     & 91.622, 92.6465000, 93.6121000, 95.272, 96.6922000,
     & 97.8452000, 99.0038000, 99.7462000, 101.644, 101.989,
     & 103.587, 105.101, 106.19, 107.058, 108.841,
     & 109.718, 111.297, 112.419, 113.546, 115.043,
     & 116.309, 117.181, 118.618, 120.162, 120.652/
      DATA WIG3/120.652, 244.138, 363.378, 490.344, 610.751,
     & 736.55, 859.653, 970.092, 1081.22/


      IE = INT(AINT(E))+1
C      IE = INT(AINT(E))
C-Add 97.03.16 Y.H
C      IF (IE .EQ.0) IE=1
      IF (IE.gt.100) THEN
C-Mod 97.03.22 K.O
C         write(*,*) "E is OUT OF RANGE...(E=",E,")"
C         write(*,*) "(Approx by E=100.)"
         IE = 100 + AINT(E/100.)
         IF (IE.GT.109) THEN
            write(*,*) "E is OUT OF RANGE...(E=",E,")"
            write(*,*) "(Approx by E=1000.)"
            IE = 109
         ENDIF
      ENDIF
*     scaling factor is applied for other target than 16O
      IF (NEDIFPI .eq. 1) THEN
         DDIFMX = SIGMAX(IE)
      ELSE IF (NEDIFPI .eq. 0) THEN
         DDIFMX = WIGMAX(IE)
      END IF

C      write(*,*)'ddifmx=',DDIFMX

      RETURN
      END
